name: 01.07.00.$(BuildID)$(Rev:.r)

trigger: none
resources:
  repositories:
  - repository: kube
    type: git
    name: logmonitorin
    #ref: pp_796513_vmrg_devop
    ref: main

variables:
  buildConfiguration: 'Release'
  system.debug: true

pool: 
  vmImage: 'ubuntu-18.04'

steps:
- checkout: kube
  #path: s/kube
  submodules: recursive
  clean: true
  persistCredentials: true



stages:
 - stage: build
displayName: Build & Test
jobs:
   - job: build_test
     displayName: Build QC Warehouse
     pool: 
       vmImage: 'ubuntu-18.04'
     container: rpd-oracle-dev
     steps:
     - checkout: self
       submodules: recursive
       clean: true
       persistCredentials: true
     - script: |
         cd build/scripts
         printf "${BUILD_BUILDNUMBER}\nY\n" | bash  QC_warehouse_build.sh
       displayName: Package
     - task: PublishPipelineArtifact@1
       inputs:
         path: $(System.DefaultWorkingDirectory)/build/dist
         artifact: dist
  